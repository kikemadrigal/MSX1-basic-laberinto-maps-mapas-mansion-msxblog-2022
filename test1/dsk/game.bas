10rem******************************
20remProgram:Laberinto
30remautor:MSXMurcia
40rem******************************
45 print "Ejecutando instrucciones"
50definta-z:DEFUSR1=&H41:DEFUSR2=&H44
60strig(0)on:onstriggosub7100
70'spriteon:ONSPRITEGOSUB2000
80screen2,0,0
85color1,15,7:keyoff
87open"grp:"as#1:gosub3000
90 print #1,"Cargando sprites"
100gosub20870
110 cls: preset (0,0):print #1,"Debes de ingeniar como salir del laberinto con las herramientas que tienes"
125 print #1,"Pero solo las puedes usar una vez"
126gosub3100
127 preset (0,21*8):print #1,"Pulsa una tecla para continuar"
128ifinkey$=""thengoto126elsecls
129'a=usr1(0)
130 print "Cargando graficos"
145gosub30000
200gosub9000
205gosub3000
206gosub7000
207gosub3100
210gosub5000
220gosub6000
230gosub8300
400gosub1260
430gosub1760
440gosub1400
460ifms>5thenmw=mw+1:ms=0:mc=1:'gosub8100
570ifmcthengosub9000
500goto400
1260ST=STICK(0)ORSTICK(1)ORSTICK(2)
1300xp=x:yp=y
1310onstgoto1320,1310,1330,1310,1340,1310,1350
1315goto1370
1320y=y-pv:pp=0:re=9:gosub4000:goto1370
1330x=x+pv:pp=2:re=9:gosub4000:goto1370
1340y=y+pv:pp=1:re=9:gosub4000:goto1370
1350x=x-pv:pp=3:re=9:gosub4000:goto1370
1370ifx<=0thenx=xp
1380ify<=0theny=yp
1385ify+ph>192theny=yp
1390ifx+pw>252thenx=xp
1395RETURN
1400PUTSPRITE0,(x,y),15,pp
1410ifen=0thenreturn
1430fori=1toen
1440ec(i)=ec(i)+1:ifec(i)>1thenec(i)=0
1450ifet(i)=0thenifec(i)=0thenes(i)=5elsees(i)=6
1460ifet(i)=1thenifec(i)=0thenes(i)=7elsees(i)=8
1490PUTSPRITE4+i,(ex(i),ey(i)),,es(i)
1495nexti
1520return
1760hl=base(5)+(y/8)*32+(x/8):a=vpeek(hl)
1770ifa>0anda<8thenx=xp:y=yp
1780'ifa=2thenx=8*16:y=8*18:beep
1790ifa=8thenmc=1:ms=ms+1
1800ifpc=1thenpc=0:spriteon
1810fori=1toen
1820ifet(i)=0thenex(i)=ex(i)+ev(i)
1830ifet(i)=1theney(i)=ey(i)+el(i)
1840hl=base(5)+(ey(i)/8)*32+(ex(i)/8):a=vpeek(hl)
1850ifa>0anda<8thenifet(i)=0thenev(i)=-ev(i):ex(i)=ep(i):ey(i)=ei(i)elseifet(i)=1thenel(i)=-el(i):ex(i)=ep(i):ey(i)=ei(i)
1860ep(i)=ex(i):ei(i)=ey(i)
1870nexti
1890return
2000ifpe=0thengosub5000
2010spriteoff:pe=pe-1:gosub3000:beep:pc=1
2090return
3000line(21*8,0)-(23*8,20*8),14,bf
3010line(24*8,0)-(247,20*8),14,bf
3020preset(25*8,3*8):print#1,"World"
3030preset(26*8,5*8):print#1,mw
3040preset(25*8,7*8):print#1,"Level"
3050preset(26*8,9*8):print#1,ms
3060preset(25*8,11*8):print#1,"Live"
3070preset(26*8,13*8):print#1,pe
3075preset(24*8,15*8):print#1,en
3080preset(24*8,17*8):print#1,fre(0)
3090return
3100PUTSPRITE11,((22*8)-4,5*8),6,10
3120PUTSPRITE12,((22*8)-4,7*8),6,11
3130PUTSPRITE13,((22*8)-4,9*8),6,12
3140PUTSPRITE14,((22*8)-4,11*8),6,13
3190return
4000ifre=1thenPLAY"O5L8V4M8000AADFG2AAAAr60GEFDCDGR8A2A2A8","o1v4cr8o2cr8o1v6cr8o2v4cr8o1cr8o2v6cr8"
4010ifre=5thenplay"l10o4v4gc"
4020ifre=6thenplay"t250o5v12dv9e"
4030ifre=7thenplay"O5L8V4M8000AADFG2AAAA"
4040ifre=8thenPLAY"S1M2000T150O7C32"
4050ifre=9thenPLAY"o2l64t255v4m6500c"
4060ifre=10thensound6,5:sound8,16:sound12,6:sound13,9
4070'fori=0to100:nexti:a=usr2(0)
4090return
5000x=0:y=0:xp=0:yp=0:pw=8:ph=8:pv=8:pe=10:pc=0
5020return
6000em=5
6010DIMex(em),ey(em),ep(em),ei(em)
6020DIMev(em),el(em)
6030DIMew(em),eh(em),es(em),ec(em)
6040DIMee(em)
6050en=0
6099return
6100en=en+1
6105ex(en)=0:ey(en)=0:ep(en)=0:ei(en)=0
6110ev(en)=8:el(en)=8
6130ew(en)=8:eh(en)=8:es(en)=5
6140ee(en)=100
6150et(en)=0
6160ec(en)=0
6190return
7000os=0
7010ox=0:oy=0
7090return
7100beep:os=os+1:ifos>4thenos=1
7110line(0,21*8)-(247,24*8),15,bf
    7120 if os=1 then ox=5*8: preset (0,21*8):print #1,"Seleccionada la espada: ":preset (0,22*8):print #1,"Puedes matar enemigos"
    7130 if os=2 then ox=7*8: preset (0,21*8):print #1,"Seleccionada el rayo:":preset (0,22*8):print #1,"Puedes romper los muros"
    7140 if os=3 then ox=9*8: preset (0,21*8):print #1,"Seleccionada la pala: ":preset (0,22*8):print #1,"Puedes dar palazos"             
    7150 if os=4 then ox=11*8: preset (0,21*8):print #1,"Seleccionada la fuerza: " :preset (0,22*8):print #1,"Puedes mover los bloques amarillos"
7160PUTSPRITE10,((22*8)-4,ox),1,9
7190return
8000mw=0:ms=0:mc=0:tn=0
8020return
8300ifms=0thenx=1*8:y=3*8:gosub6100:ex(en)=15*8:ey(en)=1*8:et(en)=0:gosub6100:ex(en)=12*8:ey(en)=16*8:et(en)=1
8380gosub3000
8390return
9000restore10000
9010fori=6144to6144+31:VPOKEi,255:nexti
9020md=6144
9030forf=0to19
9035READD$
9040forc=0to19
9060tn$=mid$(D$,c+1,1)
9070iftn$="0"thenVPOKEmd+c,&H0
9080iftn$="1"thenVPOKEmd+c,&H1
9090iftn$="2"thenVPOKEmd+c,&H2
9100iftn$="3"thenVPOKEmd+c,&H3
9110iftn$="4"thenVPOKEmd+c,&H4
9120iftn$="5"thenVPOKEmd+c,&H5
9130iftn$="6"thenVPOKEmd+c,&H6
9140iftn$="7"thenVPOKEmd+c,&H7
9150iftn$="8"thenVPOKEmd+c,&H8
9160iftn$="9"thenVPOKEmd+c,&H9
9900nextc
9910md=md+32
9920nextf
9990return
10000data04444444444444444440
10010data60300000000000000007
10020data60301222210001122107
10030data60303000030000390307
10040data60383000032200300307
10050data60121000030000300307
10060data60000000030222100307
10070data62222221030000000307
10080data69000003012222222107
10090data60000003000000000007
10100data60000003002222222227
10110data60122003000000000007
10120data60300003022222102227
10130data60301221000000300007
10140data60303000022100300007
10150data60301222000300122107
10160data60300000000300000307
10170data60122222222100000307
10180data60000000000000000397
10190data05555555555555555550
10200data11111111111111111111
10210data10100000000000000001
10220data10100111110011111101
10230data10100100010010000101
10240data10100100010010000101
10250data10100100010010000101
10260data10100100010011110101
10270data10111100010000000101
10280data10000000011111111101
10290data10000111000000000101
10300data10000101001111111111
10310data11111101001000100001
10320data10000001001000100001
10330data10111001001000000001
10340data10100000001011111001
10350data10100111111010001001
10360data10100000000010011001
10370data10111111111110000001
10380data10000000000000000001
10390data11111111111111111111
10400data11111111111111111111
10410data10100000000000000001
10420data10100111110011111101
10430data10100100010010000101
10440data10100100010010000101
10450data10100100010010000101
10460data10100100010011110101
10470data10111100010000000101
10480data10000000011111111101
10490data10000111000000000101
10500data10000101001111111111
10510data11111101001000100001
10520data10000001001000100001
10530data10111001001000000001
10540data10100000001011111001
10550data10100111111010001001
10560data10100000000010011001
10570data10111111111110000001
10580data10000000000000000001
10590data11111111111111111111
10600data11111111111111111111
10610data10100000000000000001
10620data10100111110011111101
10630data10100100010010000101
10640data10100100010010000101
10650data10100100010010000101
10660data10100100010011110101
10670data10111100010000000101
10680data10000000011111111101
10690data10000111000000000101
10700data10000101001111111111
10710data11111101001000100001
10720data10000001001000100001
10730data10111001001000000001
10740data10100000001011111001
10750data10100111111010001001
10760data10100000000010011001
10770data10111111111110000001
10780data10000000000000000001
10790data11111111111111111111
10800data11111111111111111111
10810data10100000000000000001
10820data10100111110011111101
10830data10100100010010000101
10840data10100100010010000101
10850data10100100010010000101
10860data10100100010011110101
10870data10111100010000000101
10880data10000000011111111101
10890data10000111000000000101
10900data10000101001111111111
10910data11111101001000100001
10920data10000001001000100001
10930data10111001001000000001
10940data10100000001011111001
10950data10100111111010001001
10960data10100000000010011001
10970data10111111111110000001
10980data10000000000000000001
10990data11111111111111111111
11000data11111111111111111111
11010data10100000000000000001
11020data10100111110011111101
11030data10100100010010000101
11040data10100100010010000101
11050data10100100010010000101
11060data10100100010011110101
11070data10111100010000000101
11080data10000000011111111101
11090data10000111000000000101
11100data10000101001111111111
11110data11111101001000100001
11120data10000001001000100001
11130data10111001001000000001
11140data10100000001011111001
11150data10100111111010001001
11160data10100000000010011001
11170data10111111111110000001
11180data10000000000000000001
11190data11111111111111111111
11200data11111111111111111111
11210data10100000000000000001
11220data10100111110011111101
11230data10100100010010000101
11240data10100100010010000101
11250data10100100010010000101
11260data10100100010011110101
11270data10111100010000000101
11280data10000000011111111101
11290data10000111000000000101
11300data10000101001111111111
11310data11111101001000100001
11320data10000001001000100001
11330data10111001001000000001
11340data10100000001011111001
11350data10100111111010001001
11360data10100000000010011001
11370data10111111111110000001
11380data10000000000000000001
11390data11111111111111111111
11400data11111111111111111111
11410data10100000000000000001
11420data10100111110011111101
11430data10100100010010000101
11440data10100100010010000101
11450data10100100010010000101
11460data10100100010011110101
11470data10111100010000000101
11480data10000000011111111101
11490data10000111000000000101
11500data10000101001111111111
11510data11111101001000100001
11520data10000001001000100001
11530data10111001001000000001
11540data10100000001011111001
11550data10100111111010001001
11560data10100000000010011001
11570data10111111111110000001
11580data10000000000000000001
11590data11111111111111111111
11600data11111111111111111111
11610data10100000000000000001
11620data10100111110011111101
11630data10100100010010000101
11640data10100100010010000101
11650data10100100010010000101
11660data10100100010011110101
11670data10111100010000000101
11680data10000000011111111101
11690data10000111000000000101
11700data10000101001111111111
11710data11111101001000100001
11720data10000001001000100001
11730data10111001001000000001
11740data10100000001011111001
11750data10100111111010001001
11760data10100000000010011001
11770data10111111111110000001
11780data10000000000000000001
11790data11111111111111111111
11800data11111111111111111111
11810data10100000000000000001
11820data10100111110011111101
11830data10100100010010000101
11840data10100100010010000101
11850data10100100010010000101
11860data10100100010011110101
11870data10111100010000000101
11880data10000000011111111101
11890data10000111000000000101
11900data10000101001111111111
11910data11111101001000100001
11920data10000001001000100001
11930data10111001001000000001
11940data10100000001011111001
11950data10100111111010001001
11960data10100000000010011001
11970data10111111111110000001
11980data10000000000000000001
11990data11111111111111111111
20870RESTORE20950
20880FORI=0TO13:SP$=""
20890FORJ=1TO8:READA$
20900SP$=SP$+CHR$(VAL("&H"+A$))
20901NEXTJ
20910SPRITE$(I)=SP$
20911NEXTI
20950DATA18,18,66,5A,5A,24,24,66
20960DATA18,18,24,3C,3C,18,18,3C
20970DATA18,18,10,18,1C,18,18,1C
20980DATA18,18,08,18,38,18,18,38
20990DATAE3,E3,E3,3E,3E,3E,F9,F9
21000DATA18,3C,66,42,C3,C3,C3,FF
21010DATA00,00,00,3C,42,FF,FF,FF
21020DATA81,DB,3C,18,18,66,42,C3
21030DATA00,18,7E,5A,18,24,24,66
21040DATAFF,81,81,81,81,81,81,FF
21050DATA01,02,04,88,50,20,D0,C8
21060DATA07,0E,38,70,0E,1C,70,E0
21070DATA0C,0C,0C,0C,0C,06,0F,0F
21080DATA00,23,33,FB,FB,33,23,00
20999return
30000restore30060
30005FORI=0TO(10*8)-1
30010READA$
30020VPOKEI,VAL("&H"+A$)
30030VPOKE2048+I,VAL("&H"+A$)
30040VPOKE4096+I,VAL("&H"+A$)
30050NEXTI
30060DATA00,00,00,00,00,00,00,00
30070DATAFF,FF,FF,FF,FF,FF,FF,FF
30080DATAFF,FF,FF,00,00,FF,FF,FF
30090DATAE7,E7,E7,E7,E7,E7,E7,E7
30100DATA00,F7,F7,F7,00,7F,7F,7F
30110DATAFB,FB,FB,00,BF,BF,BF,00
30120DATA77,07,77,77,77,70,77,77
30130DATAEE,EE,0E,EE,EE,EE,E0,EE
30140DATA18,3C,7E,7E,24,7E,7E,7E
30150DATA18,3C,7E,81,1C,7E,3C,18
31000RESTORE31060
31005FORI=0TO(10*8)-1
31010READA$
31020VPOKE8192+I,VAL("&H"+A$):'&h2000'
31030VPOKE10240+I,VAL("&H"+A$):'&h2800'
31040VPOKE12288+I,VAL("&H"+A$):'&h3000'
31050NEXTI
31060DATA11,11,11,11,11,11,11,11
31070DATAA1,A1,A1,A1,A1,A1,A1,A1
31080DATAA1,A1,E1,E1,E1,E1,A1,A1
31090DATAA1,A1,A1,A1,A1,A1,A1,A1
31100DATAA1,81,81,81,81,81,81,81
31110DATA81,81,81,81,81,81,81,81
31120DATA81,81,81,81,81,81,81,81
31130DATA81,81,81,81,81,81,81,81
31140DATA41,41,41,91,79,91,91,91
31150DATA71,51,51,75,85,51,51,71
31990return
